<!DOCTYPE html>
<html>
<head>
    <title>Main Page</title>
    <style>
        /* Стили для модального окна */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
        }

        .modal-content {
            background-color: #fff;
            margin: 15% auto;
            padding: 20px;
            width: 80%;
            max-width: 500px;
            border-radius: 5px;
            position: relative;
        }

        .close {
            position: absolute;
            right: 10px;
            top: 5px;
            cursor: pointer;
            font-size: 24px;
        }

        /* Стили для формы входа */
        #loginForm {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        #loginForm input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        #loginForm button {
            padding: 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <!-- Навигация -->
    <nav>
        <button id="loginBtn" onclick="openLoginModal()">Войти</button>
        <button id="eventsButton">Мероприятия</button>
        <button id="postsButton">Посты</button>
    </nav>

    <!-- Модальное окно входа -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeLoginModal()">&times;</span>
            <h2>Вход</h2>
            <form id="loginForm">
                <input type="email" id="emailInput" placeholder="Email" required>
                <input type="password" id="passwordInput" placeholder="Password" required>
                <button type="submit">Войти</button>
            </form>
        </div>
    </div>

    <!-- Контейнеры для контента -->
    <div id="eventsContainer"></div>
    <div id="postsContainer"></div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>

    <script>
        // Функции для работы с модальным окном
        function openLoginModal() {
            console.log('Opening modal');
            document.getElementById('loginModal').style.display = 'block';
        }

        function closeLoginModal() {
            console.log('Closing modal');
            document.getElementById('loginModal').style.display = 'none';
        }

        // Закрытие модального окна при клике вне его
        window.onclick = function(event) {
            const modal = document.getElementById('loginModal');
            if (event.target === modal) {
                closeLoginModal();
            }
        }

        // Инициализация Firebase
        const firebaseConfig = {
            // Ваша конфигурация Firebase
            apiKey: "ваш_ключ",
            authDomain: "ваш_домен.firebaseapp.com",
            databaseURL: "ваша_база_данных_url",
            projectId: "ваш_проект_id",
            storageBucket: "ваш_storage_bucket",
            messagingSenderId: "ваш_messaging_sender_id",
            appId: "ваш_app_id"
        };

        // Инициализация Firebase
        firebase.initializeApp(firebaseConfig);

        // Обработка формы входа
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const email = document.getElementById('emailInput').value;
            const password = document.getElementById('passwordInput').value;

            firebase.auth().signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    console.log('Успешный вход:', userCredential.user);
                    closeLoginModal();
                    alert('Успешный вход!');
                })
                .catch((error) => {
                    console.error('Ошибка входа:', error);
                    alert('Ошибка входа: ' + error.message);
                });
        });

        // Проверка состояния аутентификации
        firebase.auth().onAuthStateChanged((user) => {
            const loginBtn = document.getElementById('loginBtn');
            if (user) {
                console.log('Пользователь вошел:', user);
                loginBtn.textContent = 'Выйти';
                loginBtn.onclick = () => {
                    firebase.auth().signOut().then(() => {
                        loginBtn.textContent = 'Войти';
                        loginBtn.onclick = openLoginModal;
                    });
                };
            } else {
                console.log('Пользователь не вошел');
                loginBtn.textContent = 'Войти';
                loginBtn.onclick = openLoginModal;
            }
        });
    </script>
</body>
</html>
